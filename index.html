<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Your Taro</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body {
  background:#0e0e0e;
  color:#fff;
  font-family:Arial;
  text-align:center;
  padding:30px;
}
.deck {
  margin:15px;
  padding:15px;
  border-radius:10px;
  background:#1b1b1b;
}
.lock {
  opacity:0.5;
}
button {
  margin-top:10px;
  padding:10px 15px;
  border:none;
  border-radius:8px;
  background:#6b4eff;
  color:#fff;
}
</style>
</head>
<body>

<h1>üîÆ Your Taro</h1>

<div id="decks"></div>

<script>
const tg = Telegram.WebApp;
const userId = tg.initDataUnsafe.user.id;

const decks = [
  { id:'classic', name:'Classic Tarot', free:true },
  { id:'dark', name:'Dark Tarot', free:false },
  { id:'love', name:'Love Tarot', free:false }
];

async function loadDecks() {
  const res = await fetch('http://localhost:3000/check-vip', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({ userId })
  });
  const data = await res.json();

  const container = document.getElementById('decks');
  container.innerHTML = '';

  decks.forEach(deck => {
    const div = document.createElement('div');
    div.className = 'deck';

    if (!deck.free && !data.vip) div.classList.add('lock');

    div.innerHTML = `<h3>${deck.name}</h3>`;

    if (deck.free || data.vip) {
      const btn = document.createElement('button');
      btn.innerText = '–û—Ç–∫—Ä—ã—Ç—å';
      btn.onclick = () => alert('–¢—É—Ç –±—É–¥–µ—Ç —Ä–∞—Å–∫–ª–∞–¥');
      div.appendChild(btn);
    } else {
      const btn = document.createElement('button');
      btn.innerText = 'üîì 1 ‚≠ê';
      btn.onclick = () => tg.showPopup({
        title:'–ü–æ–∫—É–ø–∫–∞',
        message:'–ö—É–ø–∏ –∫–æ–ª–æ–¥—É –∑–∞ 1 ‚≠ê –≤ —á–∞—Ç–µ',
        buttons:[{ type:'close' }]
      });
      div.appendChild(btn);
    }

    container.appendChild(div);
  });
}

loadDecks();
tg.ready();
</script>

</body>
</html>

